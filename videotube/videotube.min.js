"use strict";((t,e,n)=>{n=n||window;let i=!1;n.addEventListener(t,function(){i||(i=!0,requestAnimationFrame(function(){n.dispatchEvent(new CustomEvent(e)),i=!1}))})})("resize","optimizedResize"),(t=>{(t=t||window).animation=function(t,e,n){const i=e.count;let o=0;e.start&&e.start.forEach(e=>{t.style[e[0]]=e[1]});const d=[];e.anim.forEach(([t,e,n])=>{const o=Math.max(e,n),s=Math.min(e,n),a=(o-s)/i;d.push({style:t,from:e,to:n,step:a,reverse:s===n})});const s=()=>{d.forEach(e=>{e.reverse?e.from-=e.step:e.from+=e.step,t.style[e.style]=e.from}),++o<i?requestAnimationFrame(s):(e.end&&e.end.forEach(e=>{t.style[e[0]]=e[1]}),n&&n())};requestAnimationFrame(s)}})();const init=()=>{const t=document.createElement("div");t.className="videotube-modal-overlay",document.body.insertAdjacentElement("beforeend",t);const e=document.createElement("div");e.id="videotube-modal-container";const n=[[3840,2160],[2560,1440],[1920,1080],[1280,720],[854,420],[640,360],[426,240]],i=()=>{const t=n.find(t=>t[0]<window.visualViewport.width)||n[n.length-1],i=document.getElementById("videotube-modal");i.width=t[0],i.height=t[1],e.style.cssText=`\n\t\t\twidth: ${t[0]};\n\t\t\theight: ${t[1]};\n\t\t`},o=()=>{const n=window.visualViewport.height,i=window.visualViewport.width,o=e.style.width,d=e.style.height;e.style.left=(i-o)/2,e.style.top=(n-d)/2,t.style.height=document.documentElement.clientHeight},d=()=>{o(),i()},s=()=>{animation(t,{end:[["display","none"]],anim:[["opacity",1,0]],count:20},()=>{t.textContent=""}),window.removeEventListener("optimizedResize",d),document.removeEventListener("keyup",a)},a=t=>{27===t.keyCode&&s()};t.addEventListener("click",s),document.addEventListener("click",e=>{const n=e.target.closest(".tube");if(!n)return;const s=n.href;let c=s.includes("youtube")?s.match(/(\?|&)v=([^&]+)/)[2]:s.match(/(\.be\/)([^&]+)/)[2];0!==c.length&&(e.preventDefault(),animation(t,{start:[["display","block"]],anim:[["opacity",0,1]],count:20}),t.insertAdjacentHTML("beforeend",`\n\t\t\t<div id="videotube-modal-loading">Загрузка...</div>\n\t\t\t<div id="videotube-modal-close">&#10006;</div>\n\t\t\t<div id="videotube-modal-container">\n\t\t\t\t<iframe src="http://youtube.com/embed/${c}" \n\t\t\t\t\tframeborder=0\n\t\t\t\t\tid="videotube-modal" \n\t\t\t\t\tallowfullscreen="">\n\t\t\t\t</iframe>\n\t\t\t</div>\n\t\t`),i(),o(),window.addEventListener("optimizedResize",d),document.addEventListener("keyup",a))})};document.addEventListener("DOMContentLoaded",init);